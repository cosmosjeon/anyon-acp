# ๋ก๊ทธ์ธ ํ์คํธ ๊ฐ์ด๋

Google OAuth ๋ก๊ทธ์ธ ๊ธฐ๋ฅ ํ์คํธ ๋ฐฉ๋ฒ์๋๋ค.

## ๐ง ๊ฐ๋ฐ ๋ชจ๋ vs ํ๋ก๋์ ๋ชจ๋

### ๊ฐ๋ฐ ๋ชจ๋ (NODE_ENV=development)
- `.env` ํ์ผ์์ `NODE_ENV=development` ์ค์
- ๋ก๊ทธ์ธ ์ ์๋์ผ๋ก `dev@example.com` ํ์คํธ ์์ ์์ฑ
- ์ค์ Google OAuth ์์ด ๋ฐ๋ก ๋ก๊ทธ์ธ๋จ
- ๋น๋ฅธ ํ์คํธ์ ์ํฉ

### ํ๋ก๋์ ๋ชจ๋ (NODE_ENV=production)
- `.env` ํ์ผ์์ `NODE_ENV=production` ์ค์
- ์ค์ Google OAuth ์ธ์ฆ ํ๋ก์ฐ ์คํ
- ์ง์ง ๊ตฌ๊ธ ๊ณ์์ผ๋ก ๋ก๊ทธ์ธ
- ์ค์ ๋ฐฐํฌ ํ๊ฒฝ ํ์คํธ์ ์ํฉ

---

## ๐ ํ์คํธ ๋ฐฉ๋ฒ

### 1. ๊ฐ๋ฐ ๋ชจ๋ ํ์คํธ (ํ์ฌ ๊ธฐ๋ณธ ์ค์)

```bash
# 1. ์๋ฒ ์์
npm run dev

# 2. ์ฑ์์ "๊ตฌ๊ธ๋ก ๋ก๊ทธ์ธ" ํด๋ฆญ
# โ ์๋์ผ๋ก dev@example.com์ผ๋ก ๋ก๊ทธ์ธ๋จ

# 3. ๋ก๊ทธ์ธ๋ ์์ ํ์ธ
curl http://localhost:4000/dev/users
```

**๊ฒฐ๊ณผ:**
- ๋ก๊ทธ์ธ ๋ฒํผ ํด๋ฆญ โ ์ฆ์ ๋ก๊ทธ์ธ ์๋ฃ
- Dev User๋ก ์๋ ๋ก๊ทธ์ธ

---

### 2. ํ๋ก๋์ ๋ชจ๋ ํ์คํธ (์ค์ Google OAuth)

#### 2-1. ํ๊ฒฝ ๋ณ์ ๋ณ๊ฒฝ

`.env` ํ์ผ ์์:
```bash
NODE_ENV=production
```

#### 2-2. ์๋ฒ ์ฌ์์

```bash
npm run dev
```

#### 2-3. ๋ก๊ทธ์ธ ํ์คํธ

1. ์ฑ์์ "๊ตฌ๊ธ๋ก ๋ก๊ทธ์ธ" ํด๋ฆญ
2. **๋ธ๋ผ์ฐ์์์ Google ๋ก๊ทธ์ธ ํ์ด์ง ์ด๋ฆผ** โจ
3. Google ๊ณ์์ผ๋ก ๋ก๊ทธ์ธ
4. ๊ถํ ํ์ฉ
5. ์๋์ผ๋ก ์ฑ์ผ๋ก ๋์์์ ๋ก๊ทธ์ธ ์๋ฃ

**์ค์:**
- Google Cloud Console์์ ์ค์ํ ๋ฆฌ๋๋์ URI๊ฐ ์ํํด์ผ ํจ
- ํ์ฌ ์ค์: `http://localhost:4000/auth/google/callback`

---

## ๐งช ๋ค์ํ ์๋๋ฆฌ์ค ํ์คํธ

### ์๋๋ฆฌ์ค 1: ์ฌ๋ฌ ๊ณ์ ํ์คํธ

**๊ฐ๋ฐ ๋ชจ๋์์ ๋ค๋ฅธ ์์ ์์ฑ:**

```bash
# PRO ํ๋ ์์ ์์ฑ
curl -X POST http://localhost:4000/dev/create-user \
  -H "Content-Type: application/json" \
  -d '{"email": "pro@example.com", "name": "Pro User", "planType": "PRO"}'

# FREE ํ๋ ์์ ์์ฑ
curl -X POST http://localhost:4000/dev/create-user \
  -H "Content-Type: application/json" \
  -d '{"email": "free@example.com", "name": "Free User", "planType": "FREE"}'

# ์์ฑ๋ ์์ ๋ชฉ๋ก ํ์ธ
curl http://localhost:4000/dev/users
```

์๋ต์์ `token` ๊ฐ์ ๋ณต์ฌํ์ฌ ์ง์ ์ฌ์ฉํ ์ ์์ต๋๋ค.

---

### ์๋๋ฆฌ์ค 2: ๋ก๊ทธ์์ ํ ์ฌ๋ก๊ทธ์ธ

1. ์ฑ ๋ด์์ ๋ก๊ทธ์์ (Settings โ ๋ก๊ทธ์์)
2. ๋ค์ ๋ก๊ทธ์ธ ํ์ด์ง๋ก ์ด๋
3. "๊ตฌ๊ธ๋ก ๋ก๊ทธ์ธ" ํด๋ฆญ
4. ์์์์ผ๋ก ๋ก๊ทธ์ธ๋๋์ง ํ์ธ

---

### ์๋๋ฆฌ์ค 3: ํํฐ ๋ง๋ฃ ํ์คํธ

```bash
# ์๋ชป๋ ํํฐ์ผ๋ก API ํธ์ถ
curl -X GET http://localhost:4000/auth/me \
  -H "Authorization: Bearer invalid_token"

# ์์ ์๋ต: 401 Unauthorized
```

---

### ์๋๋ฆฌ์ค 4: ๊ตฌ๋ ํ๋ ๋ณ๊ฒฝ ํ์คํธ

```bash
# 1. ๋จผ์ ๋ก๊ทธ์ธํด์ ํํฐ ๋ฐ๊ธฐ
# 2. PRO ํ๋์ผ๋ก ์๊ทธ๋์ด๋
curl -X POST http://localhost:4000/auth/subscription \
  -H "Authorization: Bearer YOUR_TOKEN_HERE" \
  -H "Content-Type: application/json" \
  -d '{"planType": "PRO", "status": "ACTIVE"}'

# 3. ๋ณ๊ฒฝ๋ ์๋ณด ํ์ธ
curl -X GET http://localhost:4000/auth/me \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"
```

---

## ๐ ํธ๋ฌ๋ธ์ํ

### ๋ฌธ์ 1: "๊ตฌ๊ธ๋ก ๋ก๊ทธ์ธ" ํด๋ฆญํด๋ ์๋ฌด ์ผ๋ ์ ์ผ์ด๋จ

**ํ์ธ์ฌํญ:**
1. ์๋ฒ๊ฐ ์คํ ์ค์ธ์ง ํ์ธ: `http://localhost:4000/health`
2. ์ฝ์ ๋ก๊ทธ ํ์ธ (๊ฐ๋ฐ์ ๋๊ตฌ)
3. ๋คํธ์ํฌ ์์ฒญ ํ์ธ

### ๋ฌธ์ 2: OAuth ๋ฆฌ๋๋์ ์๋ฌ

**ํ์ธ์ฌํญ:**
1. Google Cloud Console์์ ๋ฆฌ๋๋์ URI ํ์ธ
   - ๋ฑ๋ก๋ URI: `http://localhost:4000/auth/google/callback`
2. `.env` ํ์ผ์ `OAUTH_REDIRECT_URI` ํ์ธ
3. ๋์๋ฌธ์, ์ฌ๋์(/) ์ํํ ์ผ์นํ๋์ง ํ์ธ

### ๋ฌธ์ 3: Deep Link๊ฐ ์๋ํ์ง ์์

**ํ์ธ์ฌํญ:**
1. Tauri ์ฑ์ด `anyon://` ํ๋กํ์ฝ์ ๋ฑ๋กํ๋์ง ํ์ธ
2. `src-tauri/tauri.conf.json`์์ deep link ์ค์ ํ์ธ

---

## โ ์ฒดํฌ๋ฆฌ์คํธ

๋ก๊ทธ์ธ ๊ธฐ๋ฅ์ด ์๋๋ก ์๋ํ๋์ง ํ์ธ:

- [ ] ๊ฐ๋ฐ ๋ชจ๋์์ ์๋ ๋ก๊ทธ์ธ ์ฑ๊ณต
- [ ] ํ๋ก๋์ ๋ชจ๋์์ Google OAuth ํ์ด์ง ์ด๋ฆผ
- [ ] Google ๊ณ์์ผ๋ก ๋ก๊ทธ์ธ ํ ์ฑ์ผ๋ก ๋ณต๊ท
- [ ] ๋ก๊ทธ์ธ ํ ์ฌ์ฉ์ ์๋ณด ํ์๋จ (์ด๋ฆ, ์ด๋ฉ์ผ, ํ๋กํ ์ฌ์ง)
- [ ] ๊ตฌ๋ ํ๋ ์๋ณด ํ์๋จ (FREE/PRO)
- [ ] ๋ก๊ทธ์์ ํ ๋ค์ ๋ก๊ทธ์ธ ๊ฐ๋ฅ
- [ ] ํํฐ ๊ฒ์ฆ ์์ ์๋
- [ ] ์๋ชป๋ ํํฐ์ผ๋ก API ํธ์ถ ์ 401 ์๋ฌ

---

## ๐ ํ์ฌ ์ค์ ์์ฝ

| ํญ๋ชฉ | ๊ฐ |
|-----|-----|
| ์๋ฒ ํฌํธ | 4000 |
| ํ๊ฒฝ | development |
| Google Client ID | ์ค์๋จ โ |
| Google Client Secret | ์ค์๋จ โ |
| ๋ฆฌ๋๋์ URI | http://localhost:4000/auth/google/callback |
| Deep Link | anyon://auth/callback |
| JWT ๋ง๋ฃ ์๊ฐ | 7์ผ |

---

## ๐ ํ๋ก๋์ ๋ฐฐํฌ ์ ์ฒดํฌ๋ฆฌ์คํธ

- [ ] `NODE_ENV=production` ์ค์
- [ ] `JWT_SECRET` ๊ฐ๋ฅํ ๋๋ค ๋ฌธ์์ด๋ก ๋ณ๊ฒฝ
- [ ] ํ๋ก๋์ ๋๋ฉ์ธ์ ๋ฆฌ๋๋์ URI ๋ฑ๋ก
- [ ] HTTPS ์ค์
- [ ] ๋ฐ์ดํฐ๋ฒ์ด์ค ์ฐ๊ฒฐ (ํ์ฌ in-memory)
- [ ] ์๋ฌ ๋ก๊น ์ค์
- [ ] Rate limiting ์ถ๊ฐ
- [ ] CORS ์ค์ ๊ฒํ
